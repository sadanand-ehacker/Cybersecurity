Nmap ->

https://securitytrails.com/blog/top-15-nmap-commands-to-scan-remote-hosts
https://acc3ssp0int.com/2019/03/03/breaking-down-nmap-part-2/    <-  Very important to understand o/p analysis for nmap flags

nmap tool could be used as ->
- Promiscous detection as sniffing detection technique
- Could be used for NTP protocol tool and NSE scripts could be also use for NTP tool
- NMAP need NSE as resource to be used as a basic vulnerability scanner covering several vectors like SMB, HTTP and FTP, to
  do enumeration(such as NetBIOS) etc
  - cmd -> cd /usr/share/nmap/scripts/  // location for NSE scripts 
- zenmap is GUI tool for nmap, here u will also get the topology which will make ur work more easier as it indicates that
  which one is more vunerable part in the network by indicating them.
- nmap could also be use to identify live systems // nmap was able to identify live system while 'ping' does not bcz ping
 uses ICMP protocol while nmap uses the ARP protocol which is used to resolve IP to MAC address.
- The only problem with nmap is that it generate a lot of traffic and also could get the network down, So be carefull while
 using nmap
- If u do nmap scan on victim machine without honeypot u will see that only few ports r open and once the honeypot is 
 installed u will see too many ports r open and once the attacker try to connect to any service which is virtual or fake 
 service, the victim will get the information about the hacker on it's system.
- nmap for port scanning following protocols ->
	- ARP
	- TCP (Transmission Control Protocol)
	- UDP (User Datagram Protocol) 
	- SCTP (Stream Control Transmission Protocol)
	- ICMP (Internet Control Message Protocol)
	used to send error messages. The various protocols serve different purposes and system ports
	Example -> the low resource overhead of UDP is suited for real-time streaming video, where you sacrifice some lost
	packets in return for speed, while non-real time streaming videos in YouTube are buffered and use the slower, albe it
	more reliable TCP.

Port Scanning -> By doing this u will be able to identify vulnerable ports and vulnerable services, we can also use nmap for
this task.
terminal 1 -> nmap -sT ip_address // also run the wirehark when u execute this cmd, here -T is doing vanilla scan, and it is 
detectable but cmd -> nmap ip_address //is not detectable as this doesnot complete the 3 way handshake and also known as syn
scanning or half open scan.

Advance Scanning Techniques ->
- To learn more about scanning go to -> nmap.org/book/man-port-scanning-techniques.html and u will find different types of
 scans with different flag usage in 3 way handshake
- X-mas scan cmd -> nmap -sX ip_address // this send FIN, PSH, URG packets only, see Screenshot(7) to understand working
- Fin scan working -> Screenshot(6)
- So different techniques and scans have different advantages.

To get more info on victim ->
- nmap -sV -A -O ip_address // -V will help to capture the banner which help identify the service running on machine, -A will
 make the scanning aggressive and give more info, -O is to identify the OS and other info such as versions, computer name
- the only problem with nmap is that it generate a lot of traffic and also could get the network down, So be carefull while
 using nmap
- nmap -sV -A -O ip_address > victim // to write the data in file. 

NMAP NSE Scripts-> these scripts help u to search for vulnerability, to do enumeration etc
- cd /usr/share/nmap/scripts/
- ls // to list these NSE scritps


-sn -> Ping Scan // this will not do port scanning just sends ping requests, it list which hosts r UP // use -sP in it's place
Identifying Live Sytems -> Live host means the computer that is connected to the network
- ping ip_address // this is detectable, as it uses "icmp" or 'echo' protocol and if the victim has this protocol up and
 running he will reply back with the same amount of packets and same size but most firewall prevent them, if it is prevented
 then their will be no reply.
- nmap // do it from linux_networking, this is best tool considered for networking scanning.
- nmap -sn 192.168.50.1-254
- nmap was able to identify while ping does not bcz ping uses icmp protocol while nmap uses the ARP protocol, as ARP protocol
  is used to resolve IP to MAC address, Screenshot(5)

wireshark capture all the traffic going between the victim machine and hacker machine.
- On wireshark search for the port which are detected on the nmap, it will show that how the 3way handshake is done by nmap, 
So it shows that the 3 way handshake is done on each port by nmap to check whether the port is open or not, if a syn/ack is
recieved then that means the port is open 
- Now if the firewall checks out that a 3 way handshake is done and the firewall will block this IP. 

-Pn -> this is used to disable host discovery, it lists the ports open on the host, just cmd -> nmap ip_address // gives
the same output as using '-Pn' flag // it will return open ports and it return the services that belong to the open ports -@@

- nmap -sP 192.168.50.0/24 -> Skip Port Scan, this is to scan a subnet here we r scanning from 192.168.50.0 to 192.168.50.254, by
this we r now looking for hosts that r up and ping able, 'sP' This option tells Nmap not to do a port scan after host discovery, and
only print out the available hosts that responded to the scan.  It is also known as 'ping sweep', to check live host as host 'UP'
using ICMP packets.  - Udemy Practice test _3 Question 105 -@@
        -sP -PE -PA -> 'PA' flag // 'TCP ACK ping', use when ICMP and SYN r blocked, 'PE' is for ICMP echo, timestamp and netmask
	request discovery probes  - ??
-PS -> 'TCP SYN scan'

Ping sweep tools -> Solarwinds Ping sweep tool, Angry IP scanner

- When its about the time in nmap command look for T0, T1, T2 or T4 : it shows the speed(noise) of scanning, T0 being the
  lowest and T5 the noisiest. - Udemy Practice test __3 Question 19

open port response -> SYN+ACK, closed port response -> RST
-sT -> 'full open scan' or 'TCP connect' and known as {{'vanilla scan'}} for checking live hosts, this scan can be detected
       {{while simple 'nmap ip_address' could not be detected as it not completes the 3-way handshake also known as SYN scan
	   and half open scan }} - @@
	   O/P is Open ports, and services running on them
-sS -> 'steath scan' or 'half open scan', in 3 way handshake the final 'ACK' is replaced by 'RST', and show different
		services running // Udemy Practice test _5 Question 138  -@@
		O/P is Open ports, and services running on them
	Note -> If we don't specify a range of ports, nmap will perform a SYN scan on 1000 well-known ports TCP ports on
	the target
-sI -> 'IDLE/IPID header scan', to identify host port status, it keeps low profile, the zombie system is used for scan
Steps ->
- SYN+ACK send from attacker to zombie, zombie sends back the IPID, take IPID from zombie for spoofing of IP
- attacker sends the SYN packet with spoofed zombie IPID
- If port open, then target reply with SYN+ACK to zombie and zombie reply back with RST
- If port is closed, then target reply with RST to zombie and zombie doesn't reply back

open port response -> No response, closed port response -> RST
-sX -v -> 'XMAS scan' or 'Inverse TCP Flag', flags FIN, URG, PSH r send; if no flags send then it's 'NULL scan'  - @@
	Note -> This scan is very noisy, This scan only works on Linux Machines, Exploiting a subtle loophole in TCP RFC helps
	to determine the state of a port using the -sN -sF & -sX scan methods. In this scenario, the status returns either as
	closed or as open | filtered.
	O/P is Open ports, and services running on them, and their filtered state // If u will add '-reason' to the scan
	then the reason for Open port consideration would be also shown which is 'No Response'
-sF -> FIN scan, FIN packets can reliably pass firewall - Udemy Practice test _3 Question 65
-sN -> NULL scan // This scan only works if operating systemâ€™s TCP/IP implementation is based on RFC 793. RFC 793 provides
       information for basic TCP which by design had Null scan vulnerability.

Firewall present -> No response(means statefull firewall is filtering), firewall not present -> RST
-sA -> 'ACK Flag Probe Scanning', sends TCP packets with ACK flag, analyse header info such as TTL, used to identify the
       filtering system  -@@
       Note -> This scan type serves no purpose in determining the state of a port. Instead, it is used to map out firewall
       rulesets (determining whether they are stateful or not) and finding out which ports are filtered.
       Exercise -> Try this scan on windows machine by doing following changes to Firewall -> Screenshot(412)

open port response -> No response, closed port response -> Port Unreachable msg
-sU -v -> 'UDP port scanning' // most of the Malicious Programs, Trojans, Spywares uses UDP ports to access the target.

OS fingerprinting is the method used to determine the operating system running on a remote target system. It is an important
scanning method, as the attacker will have a greater probability of success if he/she knows the OS. Active stack 
fingerprinting is one of the types of OS fingerprinting

Active Stack fingerprinting is based on the fact that various vendors of OS implement the TCP stack differently.

The basic knowledge this question checks is vulnerabilities are mostly related to the OS involved, it is hence very important
to focus on finding the OS on the target machine.

{{ -sO }}-> Udemy Practice test __1 Question 127 - 

-O -> 'Active OS fingerprinting' is also use to identify the OS and other info such as versions, tool -> nmap, but the OS
      scan from nmap would require root privilages - @@

'Passive OS fingerprinting' is done by analyzing network traffic along with TTL values and Window size

-sV -> for banner grabing which help identify the service running on machine and their versions -@@
- Udemy Practice test _3 Question 59

--reason -> To tell why that port is open // https://geek-university.com/nmap/the-reason-flag/

-A -> aggressive scanning and give more info , Udemy Practice test _5 Question 125
//This is aggressive scan be carefull with this as it more easily detectable then the previous scans, this uses a variety of scan
options which r included in a single param -A, this scan take a little longer, this is also Banner Grabing  -@@

-sSV -> 'OS and Version scanning'

-oX -> Output the results in XML format to a file

-iL -> list file
--exclude -> exlude IP
-sL -> list hosts - @@
-sn -> 'No port scan', tells host up or down,  Udemy Practice test _5 Question 76
-Pn -> 'No ping scan', tells how many ports open
-PU -> 'UDP ping'
-PY -> 'SCTP init ping scan'
-PE -> 'ICMP echo ping'
-PP -> 'ICMP timestamp ping'
-PR -> 'ARP traffic'

-T4 -A -v -> intense scan, O/P is Open ports with detailed versions and OS detection, this is default scan for Zenmap - @@

- Udemy Practice test __1 Question 37
-p -> for the port scan // Udemy Practice test __1 Question 40, - Udemy Practice test _5 Question 55
- Udemy Practice test __2 Question 92
- Udemy Practice test __2 Question 101
- Udemy Practice test __3 Question 44
- Udemy Practice test _2 Question 79
- Udemy Practice test _3 Question 25
- Udemy Practice test ___6 Question 37
- Udemy Practice test ___6 Question 90 // The A record is an Address record. It returns a 32-bit IPv4 address, most commonly used
to map hostnames to an IP address of the host.References:

Important real scans for Nmap -> the 'ip_address' represents that only use single IP and ip_address/24 represents that we can use
	range of IPs
- nmap -sP 192.168.50.0/24   // for hosts UP and running or Identifying Live Sytems
- nmap -sS -O -reason ip_address/24	// for mild OS and open ports info 
- nmap -sA ip_address/24 // for firewall info
- nmap -sS -A -p 80 -reason ip_address // for detailed info for service on port and OS (Very detailed then -O)
- nmap -F ip_address/24  // this fast scan but scan for only few ports as important kind but not all of them
- nmap -sV ip_address // to know versions of ports on target
- nmap -sS ip_address/24 | grep open | cat >> results.txt // the better way to filter out results using grep for word open here 
	and store our desired output in file
- nmap -O target_ip_address -D pretended_ip_address_1, pretended_ip_address_1, pretended_ip_address_1 // using the -D will make
the source IP pretended as the mentioned fake IPs this way the target will not get the attacker IP address and out real IP address
won't be blocked by target, I have tested this on Virtual machine using tcpdump
- --spoof-mac // for spoofing the MAC address works same way as '-D'
- nmap -sS -sU -PN ip-address // this scan will drop the initial ping which firewalls might block bcz some times bcz of that some
devices r not discovered
- nmap -T4 -A -v ip_address_1 ip_address_2

Zenmap -> It is the graphical tool of nmap, here u will also get the topology which will make ur work more easier as it
 indicates that which one is more vunerable part in the network by indicating them.

Nikto tool -> It give information about the versions of the machine and exploits available in Open source Vulnerability DB(OSVDB) 
cmd -> nikto -h ip_address

OpenVAS tool -> 
cmd -> openvas-setup
cmd -> openvasmd --user=admin --new-password=admin // to change credentials when setup is done
cmd -> openvas-start // to start the tool
- click on the wizard icon on the Top left for simple and quick scan

Hping cmdline TCP/IP packet assembler and analyzer can be used to send customirized TCP/IP packets and display the target
reply as ping cmd display the ICMP Echo reply packet from targeted host, It supports TCP, UDP, ICMP and RAW-IP. hping can
be used for ->
- fragmentation, customirize packet 
- Test firewall rules
- advance port scanning
- testing net performance
- Remote OS fingerprinting
- transfering files
- traceroute
Udemy Practice test _3 Question 12
Udemy Practice test 5 Question 19

hping3 cmdline flags -> Do from PDF page 16

- hping3 -1 ip_address // -1 switch is used for Ping Scans
- hping3 -8 0-5000 -S ip_address // -8 enables SCAN mode, -S is to set SYN flag, 0-5000 is range of ports
	In the output u will get the list of ports which r responding means they r open on the system and not prevented by firewall
	or the firewall was not present on target otherwise all the ports would be represent as Closed or 'Not Responding Ports'
- hping3 -c 1 -V -p 80 -s 5555 -A ip_address // -c is packet count, -V is Verbose, -s is base port from where the packets r sent,
	-A is ACK flag , the output shows the no. of packet losts
- hping3 -c 1 -V -p 80 -s 5555 -M 0 -UPF ip_address // -M is to setTCP sequence no., -UPF is for URG, Push and FIN flags, this scan
is also known as XMAS scan, the output shows the no. of packet losts

- hping3 tool can be used for SYN flood attack(DoS attack))
- cmd -> hping3 -i u1 -S -p 80 ip_address // simulate DoS attack

- netscan (tool for network scanning)
